<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<meta http-equiv=x-ua-compatible content="IE=edge, chrome=1">
<title>FwordCTF 2021 Writeup - Ja5on's blog</title><meta name=Description content><meta property="og:title" content="FwordCTF 2021 Writeup">
<meta property="og:description" content="Writeup for FwordCTF 2021">
<meta property="og:type" content="article">
<meta property="og:url" content="http://CUHKJason.github.io/posts/fwordctf-2021/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-08-31T23:00:00+00:00">
<meta property="article:modified_time" content="2021-08-31T23:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="FwordCTF 2021 Writeup">
<meta name=twitter:description content="Writeup for FwordCTF 2021">
<meta name=application-name content="Ja5on's blog">
<meta name=apple-mobile-web-app-title content="Ja5on's blog"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://CUHKJason.github.io/posts/fwordctf-2021/><link rel=prev href=http://CUHKJason.github.io/posts/my-first-post/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"FwordCTF 2021 Writeup","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/CUHKJason.github.io\/posts\/fwordctf-2021\/"},"genre":"posts","keywords":"ctf, writeup, crypto","wordcount":459,"url":"http:\/\/CUHKJason.github.io\/posts\/fwordctf-2021\/","datePublished":"2021-08-31T23:00:00+00:00","dateModified":"2021-08-31T23:00:00+00:00","publisher":{"@type":"Organization","name":"Ja5on"},"author":{"@type":"Person","name":"Ja5on"},"description":""}</script></head>
<body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="Ja5on's blog"></a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/> Posts </a><a class=menu-item href=/categories/> Categories </a><a class=menu-item href=/tags/> Tags </a><a class=menu-item href=/about/> About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a>
</div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="Ja5on's blog"></a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a></div>
</div>
</header>
<div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div>
<main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2>
<div class=toc-content id=toc-content-auto></div>
</div><article class="page single"><h1 class="single-title animated flipInX">FwordCTF 2021 Writeup</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=/ title=Author rel=" author" class=author><i class="fas fa-user-circle fa-fw"></i>Ja5on</a></span>&nbsp;<span class=post-category>included in <a href=/categories/ctf/><i class="far fa-folder fa-fw"></i>ctf</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-08-31>2021-08-31</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;459 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;</div>
</div><div class="details toc" id=toc-static kept>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span>
</div>
<div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#leaky-blinders---crypto-100-points>Leaky Blinders - Crypto (100 points)</a>
<ul>
<li><a href=#challenge->Challenge :</a></li>
<li><a href=#files->Files :</a></li>
<li><a href=#solution->Solution :</a></li>
</ul>
</li>
<li><a href=#boombastic---crypto-738-points>Boombastic - Crypto (738 points)</a>
<ul>
<li><a href=#challenge--1>Challenge :</a></li>
<li><a href=#files--1>Files :</a></li>
<li><a href=#solution--1>Solution :</a></li>
</ul>
</li>
</ul>
</nav></div>
</div><div class=content id=content><h1 id=background>Background</h1>
<p>28 Aug 2021, 01:00 HKT â€” 29 Aug 2021, 13:00 HKT<br>
Format: Jeopardy<br>
Official URL: <a href=https://ctf.fword.tech/ target=_blank rel="noopener noreffer">https://ctf.fword.tech/</a><br>
Event organizers: Fword<br>
CTFtime: <a href=https://ctftime.org/event/1405 target=_blank rel="noopener noreffer">https://ctftime.org/event/1405</a><br>
This is the first CTF I participated after I decided to join back the CTF world. Only 2 simple crypto were solved, showing that there is plenty of rooooooooooooooooooom for improvement of my CTF skills.</p>
<h1 id=challenges>Challenges</h1>
<h2 id=leaky-blinders---crypto-100-points>Leaky Blinders - Crypto (100 points)</h2>
<h3 id=challenge->Challenge :</h3>
<blockquote>
<p>Get the flag, by order of the leaky fookin blinders..<br>
<code>nc 52.149.135.130 4869</code></p>
</blockquote>
<h3 id=files->Files :</h3>
<p><a href=https://github.com/MehdiBHA/FwordCTF-2021/blob/main/Leaky%20Blinders/leaky_blinders.py target=_blank rel="noopener noreffer">leaky_blinders.py</a></p>
<h3 id=solution->Solution :</h3>
<p>From the <code>decrypt</code> function below, we know that the provided ciphertext will xor with the provided key then perform the standard AES decryption.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>def decrypt(cipher, k):
    aes = AES.new(k, AES.MODE_ECB)
    cipher = xor(cipher, k)
    msg = unpad(aes.decrypt(cipher), 16)
    return msg
</code></pre></td></tr></table>
</div>
</div><p>The goal is to provide a ciphertext and key that output <strong>&ldquo;FwordCTF&rdquo;</strong> after the decryption. It is obvious that one can encrypt the word offline and provide the used ciphertext and key to obtain the flag.</p>
<p><strong>Solve:</strong></p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>from Crypto.Cipher import AES
from Crypto.Util.Padding import pad, unpad
import sys, os, pwc

FLAG = b&#34;FwordCTF{###############################################################}&#34;
key = os.urandom(32)

def encrypt(msg):
    aes = AES.new(key, AES.MODE_ECB)
    if len(msg) % 16 != 0:
        msg = pad(msg, 16)
    cipher = aes.encrypt(msg)
    cipher = xor(cipher, key)
    return cipher

io = pwn.remote(&#34;52.149.135.130&#34;, 4869)
io.recvuntil(b&#39;&gt; &#39;)
io.sendline(&#39;2&#39;)
io.sendline(key.hex())
io.sendline(encrypt(FLAG).hex())
io.interactive()
</code></pre></td></tr></table>
</div>
</div><p>FLAG : <strong>FwordCTF{N3v3r_x0r_w1thout_r4nd0m1s1ng_th3_k3y_0r_m4yb3_s3cur3_y0ur_c0d3}</strong></p>
<p>Official writeup : <a href=https://github.com/MehdiBHA/FwordCTF-2021/tree/main/Leaky%20Blinders target=_blank rel="noopener noreffer">The Real Crypto Solution</a></p>
<h2 id=boombastic---crypto-738-points>Boombastic - Crypto (738 points)</h2>
<h3 id=challenge--1>Challenge :</h3>
<blockquote>
<p>A pen and a paper, thats&rsquo;s all you need to watch the movie.<br>
<code>nc 52.149.135.130 4872</code></p>
</blockquote>
<h3 id=files--1>Files :</h3>
<p><a href=https://github.com/MehdiBHA/FwordCTF-2021/blob/main/Boombastic/boombastic.py target=_blank rel="noopener noreffer">boombastic.py</a></p>
<h3 id=solution--1>Solution :</h3>
<p>By doing some maths we can recover the value of <code>secret</code> from knowing <code>s</code>, <code>r</code> and <code>p</code>, as shown below (x is secret):<br>
<img class=lazyload src=/svg/loading.min.svg data-src=https://user-images.githubusercontent.com/19466939/131537192-9a076340-813e-4200-9d46-4de54dede1d7.png data-srcset="https://user-images.githubusercontent.com/19466939/131537192-9a076340-813e-4200-9d46-4de54dede1d7.png, https://user-images.githubusercontent.com/19466939/131537192-9a076340-813e-4200-9d46-4de54dede1d7.png 1.5x, https://user-images.githubusercontent.com/19466939/131537192-9a076340-813e-4200-9d46-4de54dede1d7.png 2x" data-sizes=auto alt=https://user-images.githubusercontent.com/19466939/131537192-9a076340-813e-4200-9d46-4de54dede1d7.png title=equation1><br>
<img class=lazyload src=/svg/loading.min.svg data-src=https://user-images.githubusercontent.com/19466939/131537206-2ae07e20-d713-4fa0-a9cc-89ac7ce735e1.png data-srcset="https://user-images.githubusercontent.com/19466939/131537206-2ae07e20-d713-4fa0-a9cc-89ac7ce735e1.png, https://user-images.githubusercontent.com/19466939/131537206-2ae07e20-d713-4fa0-a9cc-89ac7ce735e1.png 1.5x, https://user-images.githubusercontent.com/19466939/131537206-2ae07e20-d713-4fa0-a9cc-89ac7ce735e1.png 2x" data-sizes=auto alt=https://user-images.githubusercontent.com/19466939/131537206-2ae07e20-d713-4fa0-a9cc-89ac7ce735e1.png title=equation2><br>
<img class=lazyload src=/svg/loading.min.svg data-src=https://user-images.githubusercontent.com/19466939/131537210-8bec7101-c64a-4a27-b59e-c38c9b415801.png data-srcset="https://user-images.githubusercontent.com/19466939/131537210-8bec7101-c64a-4a27-b59e-c38c9b415801.png, https://user-images.githubusercontent.com/19466939/131537210-8bec7101-c64a-4a27-b59e-c38c9b415801.png 1.5x, https://user-images.githubusercontent.com/19466939/131537210-8bec7101-c64a-4a27-b59e-c38c9b415801.png 2x" data-sizes=auto alt=https://user-images.githubusercontent.com/19466939/131537210-8bec7101-c64a-4a27-b59e-c38c9b415801.png title=equation3><br>
<img class=lazyload src=/svg/loading.min.svg data-src=https://user-images.githubusercontent.com/19466939/131537216-7f313e67-3c60-4799-af4d-7682121ebe42.png data-srcset="https://user-images.githubusercontent.com/19466939/131537216-7f313e67-3c60-4799-af4d-7682121ebe42.png, https://user-images.githubusercontent.com/19466939/131537216-7f313e67-3c60-4799-af4d-7682121ebe42.png 1.5x, https://user-images.githubusercontent.com/19466939/131537216-7f313e67-3c60-4799-af4d-7682121ebe42.png 2x" data-sizes=auto alt=https://user-images.githubusercontent.com/19466939/131537216-7f313e67-3c60-4799-af4d-7682121ebe42.png title=equation4><br>
<img class=lazyload src=/svg/loading.min.svg data-src=https://user-images.githubusercontent.com/19466939/131537227-bb9c1081-eed2-43e9-aa28-7cbe5aa62ed6.png data-srcset="https://user-images.githubusercontent.com/19466939/131537227-bb9c1081-eed2-43e9-aa28-7cbe5aa62ed6.png, https://user-images.githubusercontent.com/19466939/131537227-bb9c1081-eed2-43e9-aa28-7cbe5aa62ed6.png 1.5x, https://user-images.githubusercontent.com/19466939/131537227-bb9c1081-eed2-43e9-aa28-7cbe5aa62ed6.png 2x" data-sizes=auto alt=https://user-images.githubusercontent.com/19466939/131537227-bb9c1081-eed2-43e9-aa28-7cbe5aa62ed6.png title=equation5><br>
<img class=lazyload src=/svg/loading.min.svg data-src=https://user-images.githubusercontent.com/19466939/131537235-6e2b5446-81f0-45ae-bf97-ebc526397843.png data-srcset="https://user-images.githubusercontent.com/19466939/131537235-6e2b5446-81f0-45ae-bf97-ebc526397843.png, https://user-images.githubusercontent.com/19466939/131537235-6e2b5446-81f0-45ae-bf97-ebc526397843.png 1.5x, https://user-images.githubusercontent.com/19466939/131537235-6e2b5446-81f0-45ae-bf97-ebc526397843.png 2x" data-sizes=auto alt=https://user-images.githubusercontent.com/19466939/131537235-6e2b5446-81f0-45ae-bf97-ebc526397843.png title=equation6><br>
Therefore we can just &ldquo;Get a ticket&rdquo; first, calculate the <code>secret</code> and &ldquo;Enter Cinema&rdquo;!</p>
<p><strong>Solve:</strong></p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>from Crypto.Util.number import inverse
from json import loads, dumps
import hashlib, sys, os, signal, pwn

def find_secret(msg):
    r = int(msg[&#39;r&#39;], 16)
    s = int(msg[&#39;s&#39;], 16)
    p = int(msg[&#39;p&#39;], 16)
    secret = (inverse((r*inverse(s, p)-s),p)*(p-2)) % p
    return secret, p

def get_ticket(code, secret, p):
    y = int(hashlib.sha256(code.encode()).hexdigest(),16)
    r = ((y**2 - 1) * (inverse(secret**2, p))) % p
    s = ((1 + y) * (inverse(secret, p))) % p
    return {&#39;s&#39;: hex(s), &#39;r&#39;: hex(r), &#39;p&#39;: hex(p)}

io = pwn.remote(&#34;52.149.135.130&#34;, 4872)
io.recvuntil(b&#39;&gt;&#39;)
io.sendline(b&#39;2&#39;)
io.recvuntil(b&#39;Your ticket : &#39;)
ticket = io.recvuntil(b&#39;}&#39;)
io.recvuntil(b&#39;&gt;&#39;)
io.sendline(b&#39;1&#39;)
io.recvuntil(b&#39;Enter the magic word : &#39;)
secret, p = find_secret(loads(ticket))
ans = dumps(get_ticket(&#34;Boombastic&#34;, secret, int(p)))
io.sendline(str.encode(ans))
print(io.recvline())
io.close()
</code></pre></td></tr></table>
</div>
</div><p>FLAG : <strong>FwordCTF{4ct_l1k3_a_V1P_4nd_b3c0m3_a_V1P}</strong></p>
<p>Official writeup : <a href=https://github.com/MehdiBHA/FwordCTF-2021/tree/main/Boombastic target=_blank rel="noopener noreffer">https://github.com/MehdiBHA/FwordCTF-2021/tree/main/Boombastic</a></p>
</div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2021-08-31</span>
</div>
<div class=post-info-license></div>
</div>
<div class=post-info-line>
<div class=post-info-md></div>
<div class=post-info-share>
<span></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/ctf/>ctf</a>,&nbsp;<a href=/tags/writeup/>writeup</a>,&nbsp;<a href=/tags/crypto/>crypto</a></section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section>
</div>
<div class=post-nav><a href=/posts/my-first-post/ class=prev rel=prev title="My First Post"><i class="fas fa-angle-left fa-fw"></i>My First Post</a></div>
</div>
</article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.88.1">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
</div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2021</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Ja5on</a></span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw"></i>
</a>
</div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:100},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body>
</html>